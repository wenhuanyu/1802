require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesA/pages/waibao/dingdan/dingdan"],{"0609":function(t,e,i){"use strict";(function(t){function i(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{items:["外包订单","验收报告","发票","延期报告"],count:0,itemCount:-1,list:[],add_list:[{text:"",image:""}],gongXulist:[{jobs_name:"",job_id:"",price:"",num:"",money:"",start_date:"",end_date:"",practical_start_date:"",practical_end_date:"",wIndex:-1}],fapiaoList:[{ton:"",money:"",deduct_money:"",earnest_money:"",reality_money:"",make_date:"",remark:""}],warehouse:[],id:"",show:!1,name:"",form:{order_num:"",contract:"",bidding:"",name:"",code:"",quartel_id:""},quartel_id:"",dunHeji:"",moneyHeji:"",DeductMoneyHeji:"",EarnestMoneyHeji:"",RealityMoneyHeji:"",icon:[]}},onLoad:function(t){var e=this;this.icon=this.common.get("icon"),t.data&&(this.id=JSON.parse(decodeURIComponent(t.data)).id),this.linban(),this.http({url:this.api.Epiboly_new_processList,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token")},success:function(t){e.warehouse=t.list}})},methods:{Ton:function(t,e){var i=this;this.fapiaoList[e].ton=t.detail.value,this.dunHeji=0,this.fapiaoList.map((function(t,e){i.dunHeji=Number(i.dunHeji)+Number(t.ton)}))},Money:function(t,e){var i=this;this.fapiaoList[e].money=t.detail.value,this.moneyHeji=0,this.fapiaoList.map((function(t,e){i.moneyHeji=Number(i.moneyHeji)+Number(t.money)}))},DeductMoney:function(t,e){var i=this;this.fapiaoList[e].deduct_money=t.detail.value,this.DeductMoneyHeji=0,this.fapiaoList.map((function(t,e){i.DeductMoneyHeji=Number(i.DeductMoneyHeji)+Number(t.deduct_money)}))},EarnestMoney:function(t,e){var i=this;this.fapiaoList[e].earnest_money=t.detail.value,this.EarnestMoneyHeji=0,this.fapiaoList.map((function(t,e){i.EarnestMoneyHeji=Number(i.EarnestMoneyHeji)+Number(t.earnest_money)}))},RealityMoney:function(t,e){var i=this;this.fapiaoList[e].reality_money=t.detail.value,this.RealityMoneyHeji=0,this.fapiaoList.map((function(t,e){i.RealityMoneyHeji=Number(i.RealityMoneyHeji)+Number(t.reality_money)}))},xuanze:function(t,e){var i=this;this.itemCount=e,this.form.name=t.name,this.form.quartel_id=t.id,this.quartel_id=t.id,0==this.count?this.http({url:this.api.Epiboly_epiboly_data_show,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token"),quartel_id:this.form.quartel_id},success:function(e){if(e.quartel_id?(i.form.quartel_id=e.quartel_id,i.form.name=e.name):(i.form.name=t.name,i.form.quartel_id=t.id),i.form.order_num=e.order_num,i.form.contract=e.contract,i.form.bidding=e.bidding,i.form.code=e.code,i.gongXulist=e.job_data,0==i.gongXulist.length){var n={job_id:"",jobs_name:"",price:"",num:"",money:"",start_date:"",end_date:"",practical_start_date:"",practical_end_date:"",wIndex:-1};i.gongXulist.push(n)}if(i.add_list=e.image_data,0==i.add_list.length){var o={text:"",image:""};i.add_list.push(o)}}}):1==this.count?this.http({url:this.api.Epiboly_show_check_report,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token"),quartel_id:this.quartel_id},success:function(e){if(e.quartel_id?i.quartel_id=e.quartel_id:i.quartel_id=t.id,i.add_list=e.list,0==i.add_list.length){var n={text:"",image:""};i.add_list.push(n)}}}):3==this.count?this.http({url:this.api.Epiboly_show_postpone_report,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token"),quartel_id:this.quartel_id},success:function(e){if(e.quartel_id?i.quartel_id=e.quartel_id:i.quartel_id=t.id,i.add_list=e.list,0==i.add_list.length){var n={text:"",image:""};i.add_list.push(n)}}}):2==this.count&&this.http({url:this.api.Epiboly_show_invoice,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token"),quartel_id:this.quartel_id},success:function(e){if(e.quartel_id?i.quartel_id=e.quartel_id:i.quartel_id=t.id,i.add_list=e.image_data,0==i.add_list.length){var n={text:"",image:""};i.add_list.push(n)}if(i.fapiaoList=e.invoice_data,i.dunHeji=0,i.moneyHeji=0,i.DeductMoneyHeji=0,i.EarnestMoneyHeji=0,i.RealityMoneyHeji=0,i.fapiaoList.map((function(t,e){i.dunHeji=Number(i.dunHeji)+Number(t.ton),i.moneyHeji=Number(i.moneyHeji)+Number(t.money),i.DeductMoneyHeji=Number(i.DeductMoneyHeji)+Number(t.deduct_money),i.EarnestMoneyHeji=Number(i.EarnestMoneyHeji)+Number(t.earnest_money),i.RealityMoneyHeji=Number(i.RealityMoneyHeji)+Number(t.reality_money)})),0==i.fapiaoList.length){var o={ton:"",money:"",deduct_money:"",earnest_money:"",reality_money:"",make_date:"",remark:""};i.fapiaoList.push(o)}}})},uploadImage:function(e){var i=this;t.chooseImage({count:1,success:function(n){var o=n.tempFilePaths[0];t.uploadFile({url:i.common.baseUrl+i.api.upload,filePath:o,name:"file",success:function(n){var o=JSON.parse(n.data);1==o.code?i.add_list[e].image=o.data.scalar:t.showToast({title:"上传失败",icon:"none"})},fail:function(e){t.showToast({title:"上传失败,"+e,icon:"none"})}})}})},previewImage:function(t){wx.previewImage({current:this.add_list[t].image,urls:[this.add_list[t].image]})},changeWarehouse:function(t,e){this.gongXulist[e].wIndex=t.target.value,this.gongXulist[e].jobs_name=this.warehouse[t.target.value].name,this.gongXulist[e].job_id=this.warehouse[t.target.value].id},changeDate:function(t,e,i){"practical_end_date"==e?this.gongXulist[i].practical_end_date=t.detail.value:"practical_start_date"==e?this.gongXulist[i].practical_start_date=t.detail.value:"end_date"==e?this.gongXulist[i].end_date=t.detail.value:"start_date"==e?this.gongXulist[i].start_date=t.detail.value:"make_date"==e&&(this.fapiaoList[i].make_date=t.detail.value)},linban:function(){var e=this;this.http({url:this.api.Epiboly_small_quartel,method:"POST",data:{uid:this.common.get("uid"),token:this.common.get("token"),quartel_id:this.id},success:function(i){0==i.list.length&&t.showToast({title:"无数据",icon:"none",duration:2e3}),e.list=i.list}})},addlinban:function(){this.show=!0},quxiao:function(){this.show=!1},queding:function(){var e=this;t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Epiboly_add_small_quartel,method:"POST",data:{uid:e.common.get("uid"),token:e.common.get("token"),quartel_id:e.id,name:e.name},success:function(i){t.showToast({title:"添加成功",icon:"none",duration:2e3}),e.show=!1,setTimeout((function(){e.linban()}),100)}})},fail:function(){},complete:function(){}})},add:function(){var t={text:"",image:""};this.add_list.push(t)},addGongxu:function(){if(0==this.count){var t={job_id:"",jobs_name:"",price:"",num:"",money:"",start_date:"",end_date:"",practical_start_date:"",practical_end_date:"",wIndex:-1};this.gongXulist.push(t)}else if(2==this.count){var e={ton:"",money:"",deduct_money:"",earnest_money:"",reality_money:"",make_date:"",remark:""};this.fapiaoList.push(e)}},delGongxu:function(e){var i=this;0==this.count?1==this.gongXulist.length?t.showToast({title:"最少增加一条工序",icon:"none",duration:2e3}):this.gongXulist.splice(e,1):2==this.count&&(1==this.fapiaoList.length?t.showToast({title:"最少增加一条",icon:"none",duration:2e3}):(this.fapiaoList.splice(e,1),this.dunHeji=0,this.moneyHeji=0,this.DeductMoneyHeji=0,this.EarnestMoneyHeji=0,this.RealityMoneyHeji=0,this.fapiaoList.map((function(t,e){i.dunHeji=Number(i.dunHeji)+Number(t.ton),i.moneyHeji=Number(i.moneyHeji)+Number(t.money),i.DeductMoneyHeji=Number(i.DeductMoneyHeji)+Number(t.deduct_money),i.EarnestMoneyHeji=Number(i.EarnestMoneyHeji)+Number(t.earnest_money),i.RealityMoneyHeji=Number(i.RealityMoneyHeji)+Number(t.reality_money)}))))},del:function(t){this.add_list.splice(t,1)},change:function(t){console.log(t),this.count=t,this.itemCount=-1,this.form={},this.gongXulist=[{job_id:"",jobs_name:"",price:"",num:"",money:"",start_date:"",end_date:"",practical_start_date:"",practical_end_date:"",wIndex:-1}],this.add_list=[{text:"",image:""}],this.fapiaoList=[{ton:"",money:"",deduct_money:"",earnest_money:"",reality_money:"",make_date:"",remark:""}]},details:function(){t.navigateTo({url:"/pagesC/pages/apply/details/details"})},submit:function(){var e=this;0==this.count?t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Epiboly_epiboly_data,method:"POST",data:n({uid:e.common.get("uid"),token:e.common.get("token"),image_data:JSON.stringify(e.add_list),job_data:JSON.stringify(e.gongXulist)},e.form),success:function(e){t.showToast({title:"添加成功",icon:"none",duration:2e3})}})},fail:function(){},complete:function(){}}):1==this.count?t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Epiboly_add_heck_report,method:"POST",data:{uid:e.common.get("uid"),token:e.common.get("token"),image_data:JSON.stringify(e.add_list),quartel_id:e.quartel_id},success:function(e){t.showToast({title:"添加成功",icon:"none",duration:2e3})}})},fail:function(){},complete:function(){}}):3==this.count?t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Epiboly_add_postpone_report,method:"POST",data:{uid:e.common.get("uid"),token:e.common.get("token"),image_data:JSON.stringify(e.add_list),quartel_id:e.quartel_id},success:function(e){t.showToast({title:"添加成功",icon:"none",duration:2e3})}})},fail:function(){},complete:function(){}}):2==this.count&&t.showModal({title:"提示",content:"确定当前操作吗？",success:function(i){i.confirm&&e.http({url:e.api.Epiboly_add_invoice,method:"POST",data:{uid:e.common.get("uid"),token:e.common.get("token"),image_data:JSON.stringify(e.add_list),invoice_data:JSON.stringify(e.fapiaoList),quartel_id:e.quartel_id},success:function(e){t.showToast({title:"添加成功",icon:"none",duration:2e3})}})},fail:function(){},complete:function(){}})}}};e.default=a}).call(this,i("d5d0")["default"])},"2e3c":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={uniTable:function(){return i.e("uni_modules/uni-table/components/uni-table/uni-table").then(i.bind(null,"cfd4"))},uniTr:function(){return i.e("uni_modules/uni-table/components/uni-tr/uni-tr").then(i.bind(null,"a209"))},uniTh:function(){return i.e("uni_modules/uni-table/components/uni-th/uni-th").then(i.bind(null,"7441"))},uniTd:function(){return i.e("uni_modules/uni-table/components/uni-td/uni-td").then(i.bind(null,"3c9c"))}},o=function(){var t=this,e=t.$createElement;t._self._c},a=[]},"30a5":function(t,e,i){},"5b09":function(t,e,i){"use strict";i.r(e);var n=i("0609"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"725c":function(t,e,i){"use strict";i.r(e);var n=i("2e3c"),o=i("5b09");for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("f522");var u,s=i("f0c5"),d=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);e["default"]=d.exports},a662:function(t,e,i){"use strict";(function(t){i("a5e5");n(i("dc04"));var e=n(i("725c"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i("97ff")["createPage"])},f522:function(t,e,i){"use strict";var n=i("30a5"),o=i.n(n);o.a}},[["a662","common/runtime","common/vendor"]]]);